<div class="card-body border-bottom py-3">
    <!-- 工具栏：搜索与筛选 -->
    <!-- 使用 GET 方法提交表单，参数会自动拼接到 URL -->
    <form method="GET" class="d-flex">
        <!-- 隐藏域：保留当前的排序参数，防止搜索后排序重置 -->
        {% if current_sort %}
            <input type="hidden" name="sort" value="{{ current_sort }}">
        {% endif %}

        <div class="text-muted">
            筛选:
            <div class="d-inline-block">
                <select name="manager" class="form-select form-select-sm" onchange="this.form.submit()">
                    <option value="">所有负责人</option>
                    <option value="me" {% if current_manager == 'me' %}selected{% endif %}>我的项目</option>
                </select>
            </div>
        </div>

        <div class="ms-auto text-muted">
            搜索:
            <div class="ms-2 d-inline-block">
                <div class="input-icon">
                        <span class="input-icon-addon">
                            <!-- Icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
                        </span>
                    <input type="text" name="q" value="{{ search_query|default:'' }}" class="form-control form-control-sm" placeholder="搜索项目名称/人员...">
                </div>
            </div>
            <button type="submit" class="btn btn-sm btn-ghost-secondary">查询</button>
        </div>
    </form>
</div>